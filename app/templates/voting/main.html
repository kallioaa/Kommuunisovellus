{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
{% endblock %}


{% block content %}
<!-- Navbar Code -->
{% include 'components/_navbar.html' %}

<!-- Introductory Text Section -->
<div>
    <div>
        <div>
            <div class="alert" role="alert">
                Welcome to the Voting section! Participate in voting or check ongoing and applied events.
            </div>
        </div>
    </div>
</div>

<!-- Events to be Voted Section -->
<div>
    <h2> Cast your vote! </h2>
    {% if events_to_be_voted_for_user_id and events_to_be_voted_for_user_id|length > 0 %}
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Username</th>
                    <th>Applied For Username</th>
                    <th>Event</th>
                    <th>Description</th>
                    <th>Event Score</th>
                    <th>Event Date</th>
                    <th>Pending Votes</th>
                    <th>True Votes</th>
                    <th>False Votes</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for item in events_to_be_voted_for_user_id %}
                <tr>
                    <td>{{ item.event_id }}</td>
                    <td>{{ item.username }}</td>
                    <td>{{ item.applied_for_username }}</td>
                    <td>{{ item.event }}</td>
                    <td>{{ item.description }}</td>
                    <td>{{ item.event_score }}</td>
                    <td>{{ item.event_date }}</td>
                    <td>{{ item.pending_votes }}</td>
                    <td>{{ item.true_votes }}</td>
                    <td>{{ item.false_votes }}</td>
                    <td>
                        <form method="POST"
                            action="{{ url_for('voting.vote_event', event_id=item.event_id, vote='true') }}"
                            style="display:inline;">
                            <button type="submit">Approve</button>
                        </form>
                        <form method="POST"
                            action="{{ url_for('voting.vote_event', event_id=item.event_id, vote='false') }}"
                            style="display:inline;">
                            <button type="submit">Disapprove</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p>No events to be voted on at the moment. Check back later!</p>
    {% endif %}
</div>

<!-- Ongoing Voting Section -->
<div>
    <h2>Voting on events created by you</h2>
    {% if events_by_user_id_in_voting and events_by_user_id_in_voting|length > 0 %}
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Username</th>
                    <th>Applied For Username</th>
                    <th>Event</th>
                    <th>Description</th>
                    <th>Event Score</th>
                    <th>Event Date</th>
                    <th>Pending Votes</th>
                    <th>True Votes</th>
                    <th>False Votes</th>
                </tr>
            </thead>
            <tbody>
                {% for item in events_by_user_id_in_voting %}
                <tr>
                    <td>{{ item.event_id }}</td>
                    <td>{{ item.username }}</td>
                    <td>{{ item.applied_for_username }}</td>
                    <td>{{ item.event }}</td>
                    <td>{{ item.description }}</td>
                    <td>{{ item.event_score }}</td>
                    <td>{{ item.event_date }}</td>
                    <td>{{ item.pending_votes }}</td>
                    <td>{{ item.true_votes }}</td>
                    <td>{{ item.false_votes }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p>No ongoing voting events. All caught up!</p>
    {% endif %}
</div>

<!-- Events Applied By User Section -->
<div>
    <h2> Voting on events applied for you </h2>
    {% if events_applied_for_user_id_in_voting and events_applied_for_user_id_in_voting|length > 0 %}
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Username</th>
                    <th>Applied For Username</th>
                    <th>Event</th>
                    <th>Description</th>
                    <th>Event Score</th>
                    <th>Event Date</th>
                    <th>Pending Votes</th>
                    <th>True Votes</th>
                    <th>False Votes</th>
                </tr>
            </thead>
            <tbody>
                {% for item in events_applied_for_user_id_in_voting %}
                <tr>
                    <td>{{ item.event_id }}</td>
                    <td>{{ item.username }}</td>
                    <td>{{ item.applied_for_username }}</td>
                    <td>{{ item.event }}</td>
                    <td>{{ item.description }}</td>
                    <td>{{ item.event_score }}</td>
                    <td>{{ item.event_date }}</td>
                    <td>{{ item.pending_votes }}</td>
                    <td>{{ item.true_votes }}</td>
                    <td>{{ item.false_votes }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p>You have not applied for any events currently being voted on.</p>
    {% endif %}
</div>
{% endblock %}
